<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Compute likelihood profiles for a fitted model — profile.glmmTMB • glmmTMB</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Compute likelihood profiles for a fitted model — profile.glmmTMB"><meta property="og:description" content="Compute likelihood profiles for a fitted model"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-standard navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">glmmTMB</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.8-9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/glmmTMB.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/covstruct.html">Covariance structures with glmmTMB</a>
    </li>
    <li>
      <a href="../articles/hacking.html">Hacking glmmTMB</a>
    </li>
    <li>
      <a href="../articles/mcmc.html">Post-hoc MCMC with glmmTMB</a>
    </li>
    <li>
      <a href="../articles/miscEx.html">Miscellaneous examples</a>
    </li>
    <li>
      <a href="../articles/model_evaluation.html">Model evaluation</a>
    </li>
    <li>
      <a href="../articles/parallel.html">Parallel optimization using glmmTMB</a>
    </li>
    <li>
      <a href="../articles/priors.html">Priors in glmmTMB</a>
    </li>
    <li>
      <a href="../articles/sim.html">Simulate from a fitted glmmTMB model or a formula</a>
    </li>
    <li>
      <a href="../articles/troubleshooting.html">Troubleshooting with glmmTMB</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="../repos/index.html">
    <span class="fa fa-database fa-lg"></span>
     
    binary packages
  </a>
</li>
<li>
  <a href="https://github.com/glmmTMB/glmmTMB" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute likelihood profiles for a fitted model</h1>
    <small class="dont-index">Source: <a href="https://github.com/glmmTMB/glmmTMB/blob/HEAD/R/profile.R" class="external-link"><code>R/profile.R</code></a></small>
    <div class="hidden name"><code>profile.glmmTMB.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute likelihood profiles for a fitted model</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for glmmTMB</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/profile.html" class="external-link">profile</a></span><span class="op">(</span></span>
<span>  <span class="va">fitted</span>,</span>
<span>  parm <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  level_max <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>  npts <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  stepfac <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">4</span>,</span>
<span>  stderr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  trace <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  parallel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"no"</span>, <span class="st">"multicore"</span>, <span class="st">"snow"</span><span class="op">)</span>,</span>
<span>  ncpus <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"profile.ncpus"</span>, <span class="fl">1L</span><span class="op">)</span>,</span>
<span>  cl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for profile.glmmTMB</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">object</span>, parm <span class="op">=</span> <span class="cn">NULL</span>, level <span class="op">=</span> <span class="fl">0.95</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>fitted</dt>
<dd><p>a fitted <code>glmmTMB</code> object</p></dd>


<dt>parm</dt>
<dd><p>which parameters to profile, specified</p><ul><li><p>by index (position)</p></li>
<li><p>by name (matching the row/column names of <code>vcov(object,full=TRUE)</code>)</p></li>
<li><p>as <code>"theta_"</code> (random-effects variance-covariance parameters) or <code>"beta_"</code> (conditional and zero-inflation parameters)</p></li>
</ul></dd>


<dt>level_max</dt>
<dd><p>maximum confidence interval target for profile</p></dd>


<dt>npts</dt>
<dd><p>target number of points in (each half of) the profile (<em>approximate</em>)</p></dd>


<dt>stepfac</dt>
<dd><p>initial step factor (fraction of estimated standard deviation)</p></dd>


<dt>stderr</dt>
<dd><p>standard errors to use as a scaling factor when picking step
sizes to compute the profile; by default (if <code>stderr</code> is
<code>NULL</code>, or <code>NA</code> for a particular element),
uses the estimated (Wald) standard errors of the parameters</p></dd>


<dt>trace</dt>
<dd><p>print tracing information? If <code>trace=FALSE</code> or 0,
no tracing; if <code>trace=1</code>, print names of parameters currently
being profiled; if <code>trace&gt;1</code>, turn on tracing for the
underlying <code>tmbprofile</code> function</p></dd>


<dt>parallel</dt>
<dd><p>method (if any) for parallel computation</p></dd>


<dt>ncpus</dt>
<dd><p>number of CPUs/cores to use for parallel computation</p></dd>


<dt>cl</dt>
<dd><p>cluster to use for parallel computation</p></dd>


<dt>...</dt>
<dd><p>additional arguments passed to <code>tmbprofile</code></p></dd>


<dt>object</dt>
<dd><p>a fitted profile (<code>profile.glmmTMB</code>) object</p></dd>


<dt>level</dt>
<dd><p>confidence level</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class <code>profile.glmmTMB</code>, which is also a
data frame, with columns <code>.par</code> (parameter being profiled),
<code>.focal</code> (value of focal parameter), value (negative log-likelihood).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Fits natural splines separately to the points from each half of the profile for each
specified parameter (i.e., values above and below the MLE), then finds the inverse functions
to estimate the endpoints of the confidence interval</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="glmmTMB.html">glmmTMB</a></span><span class="op">(</span><span class="va">count</span><span class="op">~</span> <span class="va">mined</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">site</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       zi<span class="op">=</span><span class="op">~</span><span class="va">mined</span>, family<span class="op">=</span><span class="va">poisson</span>, data<span class="op">=</span><span class="va">Salamanders</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">salamander_prof1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/profile.html" class="external-link">profile</a></span><span class="op">(</span><span class="va">m1</span>, parallel<span class="op">=</span><span class="st">"multicore"</span>,</span></span>
<span class="r-in"><span>                            ncpus<span class="op">=</span><span class="fl">2</span>, trace<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## testing</span></span></span>
<span class="r-in"><span><span class="va">salamander_prof1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/profile.html" class="external-link">profile</a></span><span class="op">(</span><span class="va">m1</span>, trace<span class="op">=</span><span class="fl">1</span>,parm<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">salamander_prof1M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/profile.html" class="external-link">profile</a></span><span class="op">(</span><span class="va">m1</span>, trace<span class="op">=</span><span class="fl">1</span>,parm<span class="op">=</span><span class="fl">1</span>, npts <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">salamander_prof2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/profile.html" class="external-link">profile</a></span><span class="op">(</span><span class="va">m1</span>, parm<span class="op">=</span><span class="st">"theta_"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">salamander_prof1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"example_files"</span>,<span class="st">"salamander_prof1.rds"</span>,package<span class="op">=</span><span class="st">"glmmTMB"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">salamander_prof1</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">.focal</span>,<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">.par</span>,scale<span class="op">=</span><span class="st">"free_x"</span><span class="op">)</span><span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">1.96</span>,linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: ggplot2</span>
<span class="r-plt img"><img src="profile.glmmTMB-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">salamander_prof1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"example_files"</span>,<span class="st">"salamander_prof1.rds"</span>,package<span class="op">=</span><span class="st">"glmmTMB"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">salamander_prof1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     2.5 %     97.5 %</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)    -0.4686460  0.4805030</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> minedno         0.6449938  1.7417972</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> zi~(Intercept)  0.6088771  1.5648495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> zi~minedno     -2.2239195 -1.1665205</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> theta_1|site.1 -1.9452621 -0.5786442</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">salamander_prof1</span>,level<span class="op">=</span><span class="fl">0.99</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     0.5 %     99.5 %</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)    -0.6830922  0.5865649</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> minedno         0.6015779  1.9853898</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> zi~(Intercept)  0.4108581  1.6910201</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> zi~minedno     -2.3713049 -0.9600516</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> theta_1|site.1 -2.1810585 -0.3697326</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Mollie Brooks, Ben Bolker, Kasper Kristensen, Martin Maechler, Arni Magnusson, Hans Skaug, Anders Nielsen, Casper Berg, Koen van Bentham.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7 and <a href="https://github.com/HenrikBengtsson/pkgdown.extras/">pkgdown.extras</a> 0.0.0.9003.</p>
</div>

      </footer></div>

  


  

  </body></html>

